<div class="step-container">
  <h1 class="trips-form__title">Which activity types are you looking for?</h1>

  <% trip = preferences_form.user_trip_status.trip %>
  <%= form_with model: preferences_form,
                url: trip_preferences_form_path(trip, preferences_form),
                method: :patch,
                class: "step-form",
                data: { turbo_frame: "_top" } do |f| %>

    <input type="hidden" name="step" value="4">

    <div class="activity-grid">

      <% activities = [
          "Cafés", "Museums", "Shopping", "Parks",
          "Photography", "Architecture", "Wine tasting",
          "Boat tours", "Street food", "Gastronomy",
          "Live shows", "Sport events"
      ] %>

      <% activities.each do |label| %>
        <label class="activity-tag <%= 'selected' if preferences_form.activity_types.include?(label) %>"
               data-controller="activity"
               data-action="click->activity#toggle">

          <input type="checkbox"
                 name="preferences_form[activity_types][]"
                 value="<%= label %>"
                 class="activity-checkbox"
                 data-activity-target="checkbox"
                 <%= 'checked' if preferences_form.activity_types.include?(label) %>>

          <span><%= label %></span>
        </label>
      <% end %>

    </div>

    <div class="button-row">
      <%= link_to "← Back",
          step3_trip_preferences_form_path(trip, preferences_form),
          data: { turbo_frame: "form_wrapper" },
          class: "trips-form__button trips-form__button--secondary" %>

      <%= f.submit "Next →", class: "trips-form__button trips-form__button--primary" %>
    </div>

  <% end %>
</div>
