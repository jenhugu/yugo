<div class="step-container">
  <h2 class="step-title">Which activity types are you looking for?</h2>

  <%= form_with model: preferences_form,
                url: preferences_form_path(preferences_form),
                method: :patch,
                class: "step-form" do |f| %>

    <input type="hidden" name="step" value="4">

    <div class="activity-grid">

      <% activities = [
          "Cafés", "Museums", "Shopping", "Parks",
          "Photography", "Architecture", "Wine tasting",
          "Boat tours", "Street food", "Gastronomy",
          "Live shows", "Sport events"
      ] %>

      <% activities.each do |label| %>
        <label class="activity-tag <%= 'selected' if preferences_form.activity_types.include?(label) %>"
               data-controller="activity"
               data-action="click->activity#toggle">

          <input type="checkbox"
                 name="preferences_form[activity_types][]"
                 value="<%= label %>"
                 class="activity-checkbox"
                 data-activity-target="checkbox"
                 <%= 'checked' if preferences_form.activity_types.include?(label) %>>

          <span><%= label %></span>
        </label>
      <% end %>

    </div>

    <div class="button-row">
      <%= link_to "← Back",
          step3_preferences_form_path(preferences_form),
          data: { turbo_frame: "form_wrapper" },
          class: "back-button" %>

      <%= f.submit "Next →", class: "next-button" %>
    </div>

  <% end %>
</div>
