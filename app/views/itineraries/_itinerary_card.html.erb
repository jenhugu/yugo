<%# Grouper les activit√©s par date %>
<% itinerary_items_by_date = itinerary.itinerary_items.order(:date, :time).group_by(&:date) %>

<%# It√©ration sur chaque jour %>
<% itinerary_items_by_date.each_with_index do |(date, activities), index| %>
  <div>
    <div class="itinerary-card__section-day">
      <%# Affiche le num√©ro du jour %>
      <h3 class="heading-3">Day <%= index + 1 %></h3>
      <%# Affiche la date format√©e (utilise la date de l'itinerary item, pas du trip) %>
      <div class="itinerary-card__date subtitle"><%= date.strftime("%d %B %Y") %></div>
    </div>

    <%# It√©ration sur les activit√©s du jour %>
    <% activities.each do |item| %>
      <%# Affiche l'heure de l'activit√© au format "9h00" %>
      <div class="trip-card__dates"><i class="fa-regular fa-clock"></i> <%= item.time.strftime("%-Hh%M") %></div>
      <div class="itinerary-card">
        <%# Tag de type d'activit√© %>
        <% if item.activity_item.activity_type.present? %>
          <span class="tag tag--transparent tag-<%= item.activity_item.activity_type.parameterize %>">
            <%= item.activity_item.activity_type.titleize %>
          </span>
        <% end %>

        <%# Affiche l'image de l'activit√© ou un message si pas d'image %>
        <div class="itinerary-card__image">
          <% if item.activity_item.image.attached? %>
            <%= image_tag item.activity_item.image, alt: item.activity_item.name %>
          <% else %>
            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: #f3f4f6; height: 100%; gap: 8px;">
              <p style="font-size: 48px; margin: 0;">üèñÔ∏è</p>
              <p class="secondary-title" style="margin: 0; text-align: center;">The activity picture went on holiday before you</p>
            </div>
          <% end %>
        </div>

        <div class="itinerary-card__content">
          <%# Affiche le nom de l'activit√© %>
          <h1 class="trip-card__title"><%= item.activity_item.name %></h1>
          <%# Affiche le tagline/description courte %>
          <p class="secondary-title"><%= item.activity_item.tagline %></p>
          <div class="activity-card__info">

            <!-- Adresse -->
            <div class="info-item">
              <i class="fa-solid fa-location-dot"></i>
              <%# Affiche l'adresse de l'activit√© %>
              <p class="secondary-title"><%= item.activity_item.address %></p>
            </div>

            <!-- Dur√©e -->
            <div class="info-item">
              <i class="fa-solid fa-stopwatch"></i>
              <%# Affiche la dur√©e en minutes %>
              <p class="secondary-title"><%= item.activity_item.duration %> minutes</p>
            </div>

            <!-- Prix -->
            <div class="info-item">
              <i class="fa-solid fa-euro-sign"></i>
              <%# Affiche le prix par personne %>
              <p class="secondary-title"><%= item.activity_item.price %>‚Ç¨/person</p>
            </div>

          </div>
        </div>
      </div>
    <% end %>
  </div>
<% end %>
