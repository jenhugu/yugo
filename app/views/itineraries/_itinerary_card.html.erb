<%# Grouper les activit√©s par date %>
<% itinerary_items_by_date = itinerary.itinerary_items.order(:date, :time).group_by(&:date) %>

<%# It√©ration sur chaque jour %>
<% itinerary_items_by_date.each_with_index do |(date, activities), index| %>
  <div>
    <div class="itinerary-card__section-day">
      <%# Affiche le num√©ro du jour %>
      <h3>Day <%= index + 1 %></h3>
      <%# Affiche la date format√©e %>
      <div class="itinerary-card__date"><%= Date.parse(@trip.date).strftime("%d %B %Y") %></div>
    </div>

    <%# It√©ration sur les activit√©s du jour %>
    <% activities.each do |item| %>
      <%# Affiche l'heure de l'activit√© %>
      <div class="trip-card__dates"><%= item.time %></div>
      <div class="itinerary-card">

        <%# Affiche l'image de l'activit√© ou un message si pas d'image %>
        <div class="itinerary-card__image">
          <% if item.activity_item.image.attached? %>
            <%= image_tag item.activity_item.image, alt: item.activity_item.name %>
          <% else %>
            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: #f3f4f6; height: 100%; gap: 8px;">
              <p style="font-size: 48px; margin: 0;">üèñÔ∏è</p>
              <p class="secondary-title" style="margin: 0; text-align: center;">The activity picture went on holiday before you</p>
            </div>
          <% end %>
        </div>

        <div class="itinerary-card__content">
          <%# Affiche le nom de l'activit√© %>
          <h1 class="trip-card__title"><%= item.activity_item.name %></h1>
          <%# Affiche le tagline/description courte %>
          <p class="secondary-title"><%= item.activity_item.tagline %></p>
          <div class="activity-card__info">

            <!-- Adresse -->
            <div class="info-item">
              <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <title>Lieu</title>
                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" fill="#F43F5E"/>
                <circle cx="12" cy="9" r="2.5" fill="#F43F5E"/>
              </svg>
              <%# Affiche l'adresse de l'activit√© %>
              <p class="secondary-title"><%= item.activity_item.address %></p>
            </div>

            <!-- Dur√©e -->
            <div class="info-item">
              <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <title>Dur√©e</title>
                <circle cx="12" cy="12" r="10" stroke="#F43F5E" stroke-width="2" fill="none"/>
                <line x1="12" y1="6" x2="12" y2="12" stroke="#F43F5E" stroke-width="2"/>
                <line x1="12" y1="12" x2="16" y2="14" stroke="#F43F5E" stroke-width="2"/>
              </svg>
              <%# Affiche la dur√©e en minutes %>
              <p class="secondary-title"><%= item.activity_item.duration %> minutes</p>
            </div>

            <!-- Prix -->
            <div class="info-item">
              <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <title>Prix</title>
                <circle cx="12" cy="12" r="10" stroke="#F43F5E" stroke-width="2" fill="none"/>
                <text x="12" y="16" text-anchor="middle" font-size="10" fill="#F43F5E">‚Ç¨</text>
              </svg>
              <%# Affiche le prix par personne %>
              <p class="secondary-title"><%= item.activity_item.price %>‚Ç¨/person</p>
            </div>

          </div>
        </div>
      </div>
    <% end %>
  </div>
<% end %>
